# Установка и настройка
- [ ] Выполнить высокоуровневый анализ оборудования, сети и дисковой подсистемы.
- [ ] В виртуализированных средах — обсудить со специалистами по инфраструктуре конфигурацию хоста и нагрузку.
- [ ] Изучить версии ОС и SQL Server, номер выпуска и установленные исправления.
- [ ] Проверить, включена ли мгновенная инициализация файла.
- [ ] Проанализировать флаги трассировки.
- [ ] Включить оптимизацию для нерегламентированных рабочих нагрузок.
- [ ] Проверить настройки памяти и параллелизма на сервере.
- [ ] Изучить настройки tempdb (включая количество файлов); в версиях SQL Server до 2016 года проверить флаг трассировки T1118 и, возможно, T1117.
- [ ] Отключить автоматическое сжатие баз данных.
- [ ] Проверить настройки файлов журнала данных и транзакций.
- [ ] Проверить число VLF в файлах журнала транзакций.
- [ ] Проверить ошибки в журнале SQL Server.
- [ ] Проверить наличие ненужного мониторинга в системе.
# Модель выполнения SQL Server и статистика ожидания
- [ ] Пронаблюдать ожидания в системе. Убедиться, что статистика ожидания репрезентативна.
- [ ] Проанализировать процентные доли ожидания сигналов и ресурсов.
- [ ] Проверить конфигурацию регулятора ресурсов, если он используется.
- [ ] Отсортировать типы ожиданий по продолжительности, чтобы было легче найти узкие места.
# Производительность дисковой подсистемы
- [ ] Проанализировать задержки дисковой подсистемы в представлении sys.dm_io_virtual_file_stats.
- [ ] Проверить, не вызвана ли высокая задержка всплесками активности ввода/вывода, изучив счетчики производительности SQL Server и ОС.
- [ ] Проверить показатели ввода/вывода на уровне виртуальной машины и хранилища, обращая внимание на «шумных соседей».
- [ ] Проверить настройки емкости дисковой очереди в стеке ввода/вывода.
- [ ] Устранить неполадки с производительностью контрольных точек SQL Server и настроить косвенные контрольные точки.
- [ ] Устранить проблемы с производительностью журнала, если наблюдаются значительные ожидания WRITELOG (см. главу 11).
- [ ] Устранить проблемы с производительностью базы данных tempdb, если наблюдается много ожиданий IO_COMPLETION, а база tempdb используется чересчур активно и вызывает задержки (см. главу 9).
- [ ] Выявить и оптимизировать неэффективные
